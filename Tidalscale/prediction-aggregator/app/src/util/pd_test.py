import pandas as pd
import numpy as np
from statsmodels.tsa.api import ExponentialSmoothing
import statsmodels
import pickle
import matplotlib.pyplot as plt
import time
import warnings
import itertools
from datetime import datetime, timedelta

warnings.filterwarnings("ignore")

pd.options.display.max_rows = 9999
pd.options.display.max_columns = 100

data = [('2022-09-28 19:49:36.951723', 66795.34234855961), ('2022-09-28 19:50:36.951723', 64671.197472462554), ('2022-09-28 19:51:36.951723', 62547.05259636548), ('2022-09-28 19:52:36.951723', 55466.569676041974), ('2022-09-28 19:53:36.951723', 54758.52138400963), ('2022-09-28 19:54:36.951723', 66795.34234855961), ('2022-09-28 19:55:36.951723', 61130.95601230079), ('2022-09-28 19:56:36.951723', 59006.81113620373), ('2022-09-28 19:57:36.951723', 58298.76284417138), ('2022-09-28 19:58:36.951723', 54050.473091977256), ('2022-09-28 19:59:36.951723', 55466.569676041974), ('2022-09-28 20:00:36.951723', 59714.85942823607), ('2022-09-28 20:01:36.951723', 50510.2316318155), ('2022-09-28 20:02:36.951723', 45553.89358758903), ('2022-09-28 20:03:36.951723', 47678.03846368609), ('2022-09-28 20:04:36.951723', 56174.61796807432), ('2022-09-28 20:05:36.951723', 51926.32821588019), ('2022-09-28 20:06:36.951723', 49094.13504775078), ('2022-09-28 20:07:36.951723', 42721.70041945962), ('2022-09-28 20:08:36.951723', 42013.652127427275), ('2022-09-28 20:09:36.951723', 43429.748711491964), ('2022-09-28 20:10:36.951723', 42721.70041945962), ('2022-09-28 20:11:36.951723', 43429.748711491964), ('2022-09-28 20:12:36.951723', 46261.94187962137), ('2022-09-28 20:13:36.951723', 40597.55554336255), ('2022-09-28 20:14:36.951723', 42721.70041945962), ('2022-09-28 20:15:36.951723', 39889.507251330215), ('2022-09-28 20:16:36.951723', 45553.89358758903), ('2022-09-28 20:17:36.951723', 46261.94187962137), ('2022-09-28 20:18:36.951723', 42013.652127427275), ('2022-09-28 20:19:36.951723', 40597.55554336255), ('2022-09-28 20:20:36.951723', 37057.3140832008), ('2022-09-28 20:21:36.951723', 37765.36237523314), ('2022-09-28 20:22:36.951723', 43429.748711491964), ('2022-09-28 20:23:36.951723', 39889.507251330215), ('2022-09-28 20:24:36.951723', 39889.507251330215), ('2022-09-28 20:25:36.951723', 37057.3140832008), ('2022-09-28 20:26:36.951723', 41305.603835394926), ('2022-09-28 20:27:36.951723', 46261.94187962137), ('2022-09-28 20:28:36.951723', 46261.94187962137), ('2022-09-28 20:29:36.951723', 46969.99017165374), ('2022-09-28 20:30:36.951723', 42721.70041945962), ('2022-09-28 20:31:36.951723', 37765.36237523314), ('2022-09-28 20:32:36.951723', 35641.21749913611), ('2022-09-28 20:33:36.951723', 37057.3140832008), ('2022-09-28 20:34:36.951723', 39889.507251330215), ('2022-09-28 20:35:36.951723', 38473.410667265525), ('2022-09-28 20:36:36.951723', 37057.3140832008), ('2022-09-28 20:37:36.951723', 37057.3140832008), ('2022-09-28 20:38:36.951723', 38473.410667265525), ('2022-09-28 20:39:36.951723', 42013.652127427275), ('2022-09-28 20:40:36.951723', 39889.507251330215), ('2022-09-28 20:41:36.951723', 40597.55554336255), ('2022-09-28 20:42:36.951723', 41305.603835394926), ('2022-09-28 20:43:36.951723', 46969.99017165374), ('2022-09-28 20:44:36.951723', 48386.08675571843), ('2022-09-28 20:45:36.951723', 44137.797003524334), ('2022-09-28 20:46:36.951723', 41305.603835394926), ('2022-09-28 20:47:36.951723', 44137.797003524334), ('2022-09-28 20:48:36.951723', 44845.84529555668), ('2022-09-28 20:49:36.951723', 43429.748711491964), ('2022-09-28 20:50:36.951723', 42013.652127427275), ('2022-09-28 20:51:36.951723', 45553.89358758903), ('2022-09-28 20:52:36.951723', 40597.55554336255), ('2022-09-28 20:53:36.951723', 45553.89358758903), ('2022-09-28 20:54:36.951723', 42013.652127427275), ('2022-09-28 20:55:36.951723', 47678.03846368609), ('2022-09-28 20:56:36.951723', 49094.13504775078), ('2022-09-28 20:57:36.951723', 51218.27992384784), ('2022-09-28 20:58:36.951723', 44137.797003524334), ('2022-09-28 20:59:36.951723', 41305.603835394926), ('2022-09-28 21:00:36.951723', 50510.2316318155), ('2022-09-28 21:01:36.951723', 46969.99017165374), ('2022-09-28 21:02:36.951723', 43429.748711491964), ('2022-09-28 21:03:36.951723', 46969.99017165374), ('2022-09-28 21:04:36.951723', 47678.03846368609), ('2022-09-28 21:05:36.951723', 51926.32821588019), ('2022-09-28 21:06:36.951723', 48386.08675571843), ('2022-09-28 21:07:36.951723', 54050.473091977256), ('2022-09-28 21:08:36.951723', 61839.00430433314), ('2022-09-28 21:09:36.951723', 56882.666260106664), ('2022-09-28 21:10:36.951723', 68919.48722465665), ('2022-09-28 21:11:36.951723', 54758.52138400963), ('2022-09-28 21:12:36.951723', 48386.08675571843), ('2022-09-28 21:13:36.951723', 52634.376507912566), ('2022-09-28 21:14:36.951723', 59006.81113620373), ('2022-09-28 21:15:36.951723', 49094.13504775078), ('2022-09-28 21:16:36.951723', 51926.32821588019), ('2022-09-28 21:17:36.951723', 59714.85942823607), ('2022-09-28 21:18:36.951723', 58298.76284417138), ('2022-09-28 21:19:36.951723', 65379.245764494895), ('2022-09-28 21:20:36.951723', 74583.87356091547), ('2022-09-28 21:21:36.951723', 71751.68039278606), ('2022-09-28 21:22:36.951723', 68919.48722465665), ('2022-09-28 21:23:36.951723', 68919.48722465665), ('2022-09-28 21:24:36.951723', 61839.00430433314), ('2022-09-28 21:25:36.951723', 63255.10088839783), ('2022-09-28 21:26:36.951723', 83788.50135733603), ('2022-09-28 21:27:36.951723', 83788.50135733603), ('2022-09-28 21:28:36.951723', 98657.51549001543), ('2022-09-28 21:29:36.951723', 77416.06672904488), ('2022-09-28 21:30:36.951723', 88036.79110953017), ('2022-09-28 21:31:36.951723', 96533.37061391838), ('2022-09-28 21:32:36.951723', 87328.74281749783), ('2022-09-28 21:33:36.951723', 83080.45306530369), ('2022-09-28 21:34:36.951723', 88744.83940156252), ('2022-09-28 21:35:36.951723', 98657.51549001543), ('2022-09-28 21:36:36.951723', 104321.90182627425), ('2022-09-28 21:37:36.951723', 112110.43303863013), ('2022-09-28 21:38:36.951723', 100073.61207408014), ('2022-09-28 21:39:36.951723', 124855.30229521247), ('2022-09-28 21:40:36.951723', 119190.91595895366), ('2022-09-28 21:41:36.951723', 110694.33645456545), ('2022-09-28 21:42:36.951723', 107862.14328643601), ('2022-09-28 21:43:36.951723', 129811.64033943898), ('2022-09-28 21:44:36.951723', 119190.91595895366), ('2022-09-28 21:45:36.951723', 129811.64033943898), ('2022-09-28 21:46:36.951723', 131935.78521553596), ('2022-09-28 21:47:36.951723', 133351.88179960073), ('2022-09-28 21:48:36.951723', 123439.20571114778), ('2022-09-28 21:49:36.951723', 124855.30229521247), ('2022-09-28 21:50:36.951723', 128395.54375537421), ('2022-09-28 21:51:36.951723', 127687.4954633419), ('2022-09-28 21:52:36.951723', 117774.81937488895), ('2022-09-28 21:53:36.951723', 110694.33645456545), ('2022-09-28 21:54:36.951723', 125563.35058724483), ('2022-09-28 21:55:36.951723', 114942.62620675957), ('2022-09-28 21:56:36.951723', 126271.39887927721), ('2022-09-28 21:57:36.951723', 120607.01254301838), ('2022-09-28 21:58:36.951723', 156717.47543666832), ('2022-09-28 21:59:36.951723', 124855.30229521247), ('2022-09-28 22:00:36.951723', 126271.39887927721), ('2022-09-28 22:01:36.951723', 143264.55788805368), ('2022-09-28 22:02:36.951723', 123439.20571114778), ('2022-09-28 22:03:36.951723', 136892.12325976248), ('2022-09-28 22:04:36.951723', 150345.04080837718), ('2022-09-28 22:05:36.951723', 137600.17155179486), ('2022-09-28 22:06:36.951723', 118482.86766692133), ('2022-09-28 22:07:36.951723', 124147.25400318015), ('2022-09-28 22:08:36.951723', 112818.48133066251), ('2022-09-28 22:09:36.951723', 112110.43303863013), ('2022-09-28 22:10:36.951723', 114234.5779147272), ('2022-09-28 22:11:36.951723', 122023.10912708308), ('2022-09-28 22:12:36.951723', 133351.88179960073), ('2022-09-28 22:13:36.951723', 150345.04080837718), ('2022-09-28 22:14:36.951723', 144680.65447211836), ('2022-09-28 22:15:36.951723', 135476.02667569777), ('2022-09-28 22:16:36.951723', 124147.25400318015), ('2022-09-28 22:17:36.951723', 130519.68863147133), ('2022-09-28 22:18:36.951723', 126979.44717130953), ('2022-09-28 22:19:36.951723', 122023.10912708308), ('2022-09-28 22:20:36.951723', 151761.13739244186), ('2022-09-28 22:21:36.951723', 137600.17155179486), ('2022-09-28 22:22:36.951723', 122023.10912708308), ('2022-09-28 22:23:36.951723', 116358.72279082425), ('2022-09-28 22:24:36.951723', 140432.36471992423), ('2022-09-28 22:25:36.951723', 129103.5920474066), ('2022-09-28 22:26:36.951723', 130519.68863147133), ('2022-09-28 22:27:36.951723', 126271.39887927721), ('2022-09-28 22:28:36.951723', 127687.4954633419), ('2022-09-28 22:29:36.951723', 118482.86766692133), ('2022-09-28 22:30:36.951723', 114234.5779147272), ('2022-09-28 22:31:36.951723', 104321.90182627425), ('2022-09-28 22:32:36.951723', 126979.44717130953), ('2022-09-28 22:33:36.951723', 114942.62620675957), ('2022-09-28 22:34:36.951723', 148928.94422431246), ('2022-09-28 22:35:36.951723', 119898.96425098601), ('2022-09-28 22:36:36.951723', 117066.77108285662), ('2022-09-28 22:37:36.951723', 127687.4954633419), ('2022-09-28 22:38:36.951723', 132643.83350756834), ('2022-09-28 22:39:36.951723', 131227.73692350366), ('2022-09-28 22:40:36.951723', 126979.44717130953), ('2022-09-28 22:41:36.951723', 104321.90182627425), ('2022-09-28 22:42:36.951723', 102197.7569501772), ('2022-09-28 22:43:36.951723', 141848.46130398897), ('2022-09-28 22:44:36.951723', 125563.35058724483), ('2022-09-28 22:45:36.951723', 113526.52962269486), ('2022-09-28 22:46:36.951723', 131227.73692350366), ('2022-09-28 22:47:36.951723', 139016.26813585954), ('2022-09-28 22:48:36.951723', 130519.68863147133), ('2022-09-28 22:49:36.951723', 126271.39887927721), ('2022-09-28 22:50:36.951723', 99365.56378204782), ('2022-09-28 22:51:36.951723', 115650.6744987919), ('2022-09-28 22:52:36.951723', 146804.79934821543), ('2022-09-28 22:53:36.951723', 134767.9783836654), ('2022-09-28 22:54:36.951723', 140432.36471992423), ('2022-09-28 22:55:36.951723', 119190.91595895366), ('2022-09-28 22:56:36.951723', 122023.10912708308), ('2022-09-28 22:57:36.951723', 124147.25400318015), ('2022-09-28 22:58:36.951723', 131227.73692350366), ('2022-09-28 22:59:36.951723', 102905.80524220955), ('2022-09-28 23:00:36.951723', 123439.20571114778), ('2022-09-28 23:01:36.951723', 117066.77108285662), ('2022-09-28 23:02:36.951723', 124855.30229521247), ('2022-09-28 23:03:36.951723', 116358.72279082425), ('2022-09-28 23:04:36.951723', 117066.77108285662), ('2022-09-28 23:05:36.951723', 117774.81937488895), ('2022-09-28 23:06:36.951723', 109986.28816253306), ('2022-09-28 23:07:36.951723', 101489.70865814487), ('2022-09-28 23:08:36.951723', 97949.46719798312), ('2022-09-28 23:09:36.951723', 105029.95011830663), ('2022-09-28 23:10:36.951723', 106446.04670237131), ('2022-09-28 23:11:36.951723', 112818.48133066251), ('2022-09-28 23:12:36.951723', 113526.52962269486), ('2022-09-28 23:13:36.951723', 109278.23987050075), ('2022-09-28 23:14:36.951723', 111402.38474659779), ('2022-09-28 23:15:36.951723', 108570.19157846837), ('2022-09-28 23:16:36.951723', 107862.14328643601), ('2022-09-28 23:17:36.951723', 107154.0949944037), ('2022-09-28 23:18:36.951723', 95117.27402985367), ('2022-09-28 23:19:36.951723', 102905.80524220955), ('2022-09-28 23:20:36.951723', 100073.61207408014), ('2022-09-28 23:21:36.951723', 108570.19157846837), ('2022-09-28 23:22:36.951723', 118482.86766692133), ('2022-09-28 23:23:36.951723', 100781.6603661125), ('2022-09-28 23:24:36.951723', 96533.37061391838), ('2022-09-28 23:25:36.951723', 121315.06083505071), ('2022-09-28 23:26:36.951723', 102197.7569501772), ('2022-09-28 23:27:36.951723', 114942.62620675957), ('2022-09-28 23:28:36.951723', 121315.06083505071), ('2022-09-28 23:29:36.951723', 111402.38474659779), ('2022-09-28 23:30:36.951723', 118482.86766692133), ('2022-09-28 23:31:36.951723', 115650.6744987919), ('2022-09-28 23:32:36.951723', 129811.64033943898), ('2022-09-28 23:33:36.951723', 100781.6603661125), ('2022-09-28 23:34:36.951723', 96533.37061391838), ('2022-09-28 23:35:36.951723', 116358.72279082425), ('2022-09-28 23:36:36.951723', 105737.998410339), ('2022-09-28 23:37:36.951723', 100073.61207408014), ('2022-09-28 23:38:36.951723', 118482.86766692133), ('2022-09-28 23:39:36.951723', 97241.41890595073), ('2022-09-28 23:40:36.951723', 100781.6603661125), ('2022-09-28 23:41:36.951723', 88036.79110953017), ('2022-09-28 23:42:36.951723', 104321.90182627425), ('2022-09-28 23:43:36.951723', 92993.12915375663), ('2022-09-28 23:44:36.951723', 90868.98427765958), ('2022-09-28 23:45:36.951723', 100781.6603661125), ('2022-09-28 23:46:36.951723', 134767.9783836654), ('2022-09-28 23:47:36.951723', 100781.6603661125), ('2022-09-28 23:48:36.951723', 112818.48133066251), ('2022-09-28 23:49:36.951723', 109278.23987050075), ('2022-09-28 23:50:36.951723', 107154.0949944037), ('2022-09-28 23:51:36.951723', 83788.50135733603), ('2022-09-28 23:52:36.951723', 118482.86766692133), ('2022-09-28 23:53:36.951723', 110694.33645456545), ('2022-09-28 23:54:36.951723', 111402.38474659779), ('2022-09-28 23:55:36.951723', 125563.35058724483), ('2022-09-28 23:56:36.951723', 107862.14328643601), ('2022-09-28 23:57:36.951723', 101489.70865814487), ('2022-09-28 23:58:36.951723', 106446.04670237131), ('2022-09-28 23:59:36.951723', 114234.5779147272), ('2022-09-29 00:00:36.951723', 108570.19157846837), ('2022-09-29 00:01:36.951723', 126979.44717130953), ('2022-09-29 00:02:36.951723', 115650.6744987919), ('2022-09-29 00:03:36.951723', 100073.61207408014), ('2022-09-29 00:04:36.951723', 96533.37061391838), ('2022-09-29 00:05:36.951723', 106446.04670237131), ('2022-09-29 00:06:36.951723', 117774.81937488895), ('2022-09-29 00:07:36.951723', 107862.14328643601), ('2022-09-29 00:08:36.951723', 121315.06083505071), ('2022-09-29 00:09:36.951723', 104321.90182627425), ('2022-09-29 00:10:36.951723', 114942.62620675957), ('2022-09-29 00:11:36.951723', 112110.43303863013), ('2022-09-29 00:12:36.951723', 100781.6603661125), ('2022-09-29 00:13:36.951723', 107862.14328643601), ('2022-09-29 00:14:36.951723', 114234.5779147272), ('2022-09-29 00:15:36.951723', 117774.81937488895), ('2022-09-29 00:16:36.951723', 102197.7569501772), ('2022-09-29 00:17:36.951723', 119898.96425098601), ('2022-09-29 00:18:36.951723', 117774.81937488895), ('2022-09-29 00:19:36.951723', 105029.95011830663), ('2022-09-29 00:20:36.951723', 93701.17744578898), ('2022-09-29 00:21:36.951723', 95117.27402985367), ('2022-09-29 00:22:36.951723', 98657.51549001543), ('2022-09-29 00:23:36.951723', 117066.77108285662), ('2022-09-29 00:24:36.951723', 89452.88769359485), ('2022-09-29 00:25:36.951723', 94409.22573782134), ('2022-09-29 00:26:36.951723', 97241.41890595073), ('2022-09-29 00:27:36.951723', 90868.98427765958), ('2022-09-29 00:28:36.951723', 95117.27402985367), ('2022-09-29 00:29:36.951723', 92285.08086172429), ('2022-09-29 00:30:36.951723', 78124.11502107722), ('2022-09-29 00:31:36.951723', 72459.7286848184), ('2022-09-29 00:32:36.951723', 64671.197472462554), ('2022-09-29 00:33:36.951723', 71043.63210075372), ('2022-09-29 00:34:36.951723', 69627.53551668902), ('2022-09-29 00:35:36.951723', 75999.97014498018), ('2022-09-29 00:36:36.951723', 79540.21160514194), ('2022-09-29 00:37:36.951723', 67503.39064059196), ('2022-09-29 00:38:36.951723', 61130.95601230079), ('2022-09-29 00:39:36.951723', 71043.63210075372), ('2022-09-29 00:40:36.951723', 67503.39064059196), ('2022-09-29 00:41:36.951723', 64671.197472462554), ('2022-09-29 00:42:36.951723', 54758.52138400963), ('2022-09-29 00:43:36.951723', 56882.666260106664), ('2022-09-29 00:44:36.951723', 62547.05259636548), ('2022-09-29 00:45:36.951723', 68211.4389326243), ('2022-09-29 00:46:36.951723', 59714.85942823607), ('2022-09-29 00:47:36.951723', 54758.52138400963), ('2022-09-29 00:48:36.951723', 51218.27992384784), ('2022-09-29 00:49:36.951723', 47678.03846368609), ('2022-09-29 00:50:36.951723', 56882.666260106664), ('2022-09-29 00:51:36.951723', 53342.424799944914), ('2022-09-29 00:52:36.951723', 52634.376507912566), ('2022-09-29 00:53:36.951723', 46969.99017165374), ('2022-09-29 00:54:36.951723', 41305.603835394926), ('2022-09-29 00:55:36.951723', 46969.99017165374), ('2022-09-29 00:56:36.951723', 45553.89358758903), ('2022-09-29 00:57:36.951723', 42721.70041945962), ('2022-09-29 00:58:36.951723', 39889.507251330215), ('2022-09-29 00:59:36.951723', 39889.507251330215), ('2022-09-29 01:00:36.951723', 39181.45895929787), ('2022-09-29 01:01:36.951723', 38473.410667265525), ('2022-09-29 01:02:36.951723', 43429.748711491964), ('2022-09-29 01:03:36.951723', 46969.99017165374), ('2022-09-29 01:04:36.951723', 37057.3140832008), ('2022-09-29 01:05:36.951723', 42721.70041945962), ('2022-09-29 01:06:36.951723', 38473.410667265525), ('2022-09-29 01:07:36.951723', 38473.410667265525), ('2022-09-29 01:08:36.951723', 39181.45895929787), ('2022-09-29 01:09:36.951723', 45553.89358758903), ('2022-09-29 01:10:36.951723', 43429.748711491964), ('2022-09-29 01:11:36.951723', 48386.08675571843), ('2022-09-29 01:12:36.951723', 38473.410667265525), ('2022-09-29 01:13:36.951723', 42721.70041945962), ('2022-09-29 01:14:36.951723', 43429.748711491964), ('2022-09-29 01:15:36.951723', 37765.36237523314), ('2022-09-29 01:16:36.951723', 39889.507251330215), ('2022-09-29 01:17:36.951723', 39181.45895929787), ('2022-09-29 01:18:36.951723', 39181.45895929787), ('2022-09-29 01:19:36.951723', 40597.55554336255), ('2022-09-29 01:20:36.951723', 37765.36237523314), ('2022-09-29 01:21:36.951723', 39181.45895929787), ('2022-09-29 01:22:36.951723', 39889.507251330215), ('2022-09-29 01:23:36.951723', 40597.55554336255), ('2022-09-29 01:24:36.951723', 49094.13504775078), ('2022-09-29 01:25:36.951723', 37765.36237523314), ('2022-09-29 01:26:36.951723', 39181.45895929787), ('2022-09-29 01:27:36.951723', 39181.45895929787), ('2022-09-29 01:28:36.951723', 35641.21749913611), ('2022-09-29 01:29:36.951723', 37765.36237523314), ('2022-09-29 01:30:36.951723', 40597.55554336255), ('2022-09-29 01:31:36.951723', 43429.748711491964), ('2022-09-29 01:32:36.951723', 42721.70041945962), ('2022-09-29 01:33:36.951723', 41305.603835394926), ('2022-09-29 01:34:36.951723', 42013.652127427275), ('2022-09-29 01:35:36.951723', 39181.45895929787), ('2022-09-29 01:36:36.951723', 42721.70041945962), ('2022-09-29 01:37:36.951723', 38473.410667265525), ('2022-09-29 01:38:36.951723', 41305.603835394926), ('2022-09-29 01:39:36.951723', 40597.55554336255), ('2022-09-29 01:40:36.951723', 41305.603835394926), ('2022-09-29 01:41:36.951723', 43429.748711491964), ('2022-09-29 01:42:36.951723', 40597.55554336255), ('2022-09-29 01:43:36.951723', 45553.89358758903), ('2022-09-29 01:44:36.951723', 44845.84529555668), ('2022-09-29 01:45:36.951723', 46261.94187962137), ('2022-09-29 01:46:36.951723', 49094.13504775078), ('2022-09-29 01:47:36.951723', 46969.99017165374), ('2022-09-29 01:48:36.951723', 43429.748711491964), ('2022-09-29 01:49:36.951723', 59006.81113620373), ('2022-09-29 01:50:36.951723', 51218.27992384784), ('2022-09-29 01:51:36.951723', 49094.13504775078), ('2022-09-29 01:52:36.951723', 51218.27992384784), ('2022-09-29 01:53:36.951723', 54050.473091977256), ('2022-09-29 01:54:36.951723', 51926.32821588019), ('2022-09-29 01:55:36.951723', 49802.18333978316), ('2022-09-29 01:56:36.951723', 51218.27992384784), ('2022-09-29 01:57:36.951723', 63255.10088839783), ('2022-09-29 01:58:36.951723', 54050.473091977256), ('2022-09-29 01:59:36.951723', 63963.149180430206), ('2022-09-29 02:00:36.951723', 53342.424799944914), ('2022-09-29 02:01:36.951723', 63963.149180430206), ('2022-09-29 02:02:36.951723', 66087.29405652724), ('2022-09-29 02:03:36.951723', 66795.34234855961), ('2022-09-29 02:04:36.951723', 52634.376507912566), ('2022-09-29 02:05:36.951723', 59714.85942823607), ('2022-09-29 02:06:36.951723', 53342.424799944914), ('2022-09-29 02:07:36.951723', 57590.71455213901), ('2022-09-29 02:08:36.951723', 54050.473091977256), ('2022-09-29 02:09:36.951723', 59006.81113620373), ('2022-09-29 02:10:36.951723', 61839.00430433314), ('2022-09-29 02:11:36.951723', 62547.05259636548), ('2022-09-29 02:12:36.951723', 71043.63210075372), ('2022-09-29 02:13:36.951723', 73875.82526888313), ('2022-09-29 02:14:36.951723', 84496.54964936842), ('2022-09-29 02:15:36.951723', 87328.74281749783), ('2022-09-29 02:16:36.951723', 83080.45306530369), ('2022-09-29 02:17:36.951723', 89452.88769359485), ('2022-09-29 02:18:36.951723', 95117.27402985367), ('2022-09-29 02:19:36.951723', 95117.27402985367), ('2022-09-29 02:20:36.951723', 99365.56378204782), ('2022-09-29 02:21:36.951723', 82372.40477327135), ('2022-09-29 02:22:36.951723', 91577.03256969193), ('2022-09-29 02:23:36.951723', 84496.54964936842), ('2022-09-29 02:24:36.951723', 90160.93598562723), ('2022-09-29 02:25:36.951723', 95825.32232188605), ('2022-09-29 02:26:36.951723', 90868.98427765958), ('2022-09-29 02:27:36.951723', 109986.28816253306), ('2022-09-29 02:28:36.951723', 117774.81937488895), ('2022-09-29 02:29:36.951723', 98657.51549001543), ('2022-09-29 02:30:36.951723', 120607.01254301838), ('2022-09-29 02:31:36.951723', 126979.44717130953), ('2022-09-29 02:32:36.951723', 123439.20571114778), ('2022-09-29 02:33:36.951723', 120607.01254301838), ('2022-09-29 02:34:36.951723', 109278.23987050075), ('2022-09-29 02:35:36.951723', 118482.86766692133), ('2022-09-29 02:36:36.951723', 133351.88179960073), ('2022-09-29 02:37:36.951723', 125563.35058724483), ('2022-09-29 02:38:36.951723', 119898.96425098601), ('2022-09-29 02:39:36.951723', 117774.81937488895), ('2022-09-29 02:40:36.951723', 109986.28816253306), ('2022-09-29 02:41:36.951723', 114942.62620675957), ('2022-09-29 02:42:36.951723', 124855.30229521247), ('2022-09-29 02:43:36.951723', 122023.10912708308), ('2022-09-29 02:44:36.951723', 119190.91595895366), ('2022-09-29 02:45:36.951723', 116358.72279082425), ('2022-09-29 02:46:36.951723', 118482.86766692133), ('2022-09-29 02:47:36.951723', 114234.5779147272), ('2022-09-29 02:48:36.951723', 125563.35058724483), ('2022-09-29 02:49:36.951723', 122023.10912708308), ('2022-09-29 02:50:36.951723', 119898.96425098601), ('2022-09-29 02:51:36.951723', 134767.9783836654), ('2022-09-29 02:52:36.951723', 102905.80524220955), ('2022-09-29 02:53:36.951723', 144680.65447211836), ('2022-09-29 02:54:36.951723', 153885.28226853893), ('2022-09-29 02:55:36.951723', 134767.9783836654), ('2022-09-29 02:56:36.951723', 141140.41301195658), ('2022-09-29 02:57:36.951723', 123439.20571114778), ('2022-09-29 02:58:36.951723', 126979.44717130953), ('2022-09-29 02:59:36.951723', 126979.44717130953), ('2022-09-29 03:00:36.951723', 153177.2339765066), ('2022-09-29 03:01:36.951723', 139016.26813585954), ('2022-09-29 03:02:36.951723', 139724.31642789184), ('2022-09-29 03:03:36.951723', 114942.62620675957), ('2022-09-29 03:04:36.951723', 115650.6744987919), ('2022-09-29 03:05:36.951723', 129103.5920474066), ('2022-09-29 03:06:36.951723', 134059.93009163308), ('2022-09-29 03:07:36.951723', 126271.39887927721), ('2022-09-29 03:08:36.951723', 121315.06083505071), ('2022-09-29 03:09:36.951723', 112818.48133066251), ('2022-09-29 03:10:36.951723', 117774.81937488895), ('2022-09-29 03:11:36.951723', 124147.25400318015), ('2022-09-29 03:12:36.951723', 108570.19157846837), ('2022-09-29 03:13:36.951723', 114942.62620675957), ('2022-09-29 03:14:36.951723', 115650.6744987919), ('2022-09-29 03:15:36.951723', 126979.44717130953), ('2022-09-29 03:16:36.951723', 136892.12325976248), ('2022-09-29 03:17:36.951723', 137600.17155179486), ('2022-09-29 03:18:36.951723', 134059.93009163308), ('2022-09-29 03:19:36.951723', 120607.01254301838), ('2022-09-29 03:20:36.951723', 133351.88179960073), ('2022-09-29 03:21:36.951723', 127687.4954633419), ('2022-09-29 03:22:36.951723', 117774.81937488895), ('2022-09-29 03:23:36.951723', 103613.85353424193), ('2022-09-29 03:24:36.951723', 124147.25400318015), ('2022-09-29 03:25:36.951723', 122023.10912708308), ('2022-09-29 03:26:36.951723', 115650.6744987919), ('2022-09-29 03:27:36.951723', 117066.77108285662), ('2022-09-29 03:28:36.951723', 125563.35058724483), ('2022-09-29 03:29:36.951723', 111402.38474659779), ('2022-09-29 03:30:36.951723', 104321.90182627425), ('2022-09-29 03:31:36.951723', 131227.73692350366), ('2022-09-29 03:32:36.951723', 143264.55788805368), ('2022-09-29 03:33:36.951723', 119190.91595895366), ('2022-09-29 03:34:36.951723', 120607.01254301838), ('2022-09-29 03:35:36.951723', 118482.86766692133), ('2022-09-29 03:36:36.951723', 126979.44717130953), ('2022-09-29 03:37:36.951723', 113526.52962269486), ('2022-09-29 03:38:36.951723', 118482.86766692133), ('2022-09-29 03:39:36.951723', 120607.01254301838), ('2022-09-29 03:40:36.951723', 124855.30229521247), ('2022-09-29 03:41:36.951723', 130519.68863147133), ('2022-09-29 03:42:36.951723', 114234.5779147272), ('2022-09-29 03:43:36.951723', 136184.0749677301), ('2022-09-29 03:44:36.951723', 122731.15741911542), ('2022-09-29 03:45:36.951723', 119190.91595895366), ('2022-09-29 03:46:36.951723', 107862.14328643601), ('2022-09-29 03:47:36.951723', 137600.17155179486), ('2022-09-29 03:48:36.951723', 131227.73692350366), ('2022-09-29 03:49:36.951723', 117774.81937488895), ('2022-09-29 03:50:36.951723', 97241.41890595073), ('2022-09-29 03:51:36.951723', 130519.68863147133), ('2022-09-29 03:52:36.951723', 135476.02667569777), ('2022-09-29 03:53:36.951723', 129103.5920474066), ('2022-09-29 03:54:36.951723', 125563.35058724483), ('2022-09-29 03:55:36.951723', 102197.7569501772), ('2022-09-29 03:56:36.951723', 99365.56378204782), ('2022-09-29 03:57:36.951723', 105737.998410339), ('2022-09-29 03:58:36.951723', 106446.04670237131), ('2022-09-29 03:59:36.951723', 104321.90182627425), ('2022-09-29 04:00:36.951723', 110694.33645456545), ('2022-09-29 04:01:36.951723', 104321.90182627425), ('2022-09-29 04:02:36.951723', 128395.54375537421), ('2022-09-29 04:03:36.951723', 128395.54375537421), ('2022-09-29 04:04:36.951723', 114942.62620675957), ('2022-09-29 04:05:36.951723', 105737.998410339), ('2022-09-29 04:06:36.951723', 107862.14328643601), ('2022-09-29 04:07:36.951723', 117066.77108285662), ('2022-09-29 04:08:36.951723', 100073.61207408014), ('2022-09-29 04:09:36.951723', 95117.27402985367), ('2022-09-29 04:10:36.951723', 102197.7569501772), ('2022-09-29 04:11:36.951723', 92993.12915375663), ('2022-09-29 04:12:36.951723', 99365.56378204782), ('2022-09-29 04:13:36.951723', 109986.28816253306), ('2022-09-29 04:14:36.951723', 90868.98427765958), ('2022-09-29 04:15:36.951723', 95117.27402985367), ('2022-09-29 04:16:36.951723', 89452.88769359485), ('2022-09-29 04:17:36.951723', 95825.32232188605), ('2022-09-29 04:18:36.951723', 101489.70865814487), ('2022-09-29 04:19:36.951723', 88036.79110953017), ('2022-09-29 04:20:36.951723', 90160.93598562723), ('2022-09-29 04:21:36.951723', 93701.17744578898), ('2022-09-29 04:22:36.951723', 81664.35648123901), ('2022-09-29 04:23:36.951723', 91577.03256969193), ('2022-09-29 04:24:36.951723', 93701.17744578898), ('2022-09-29 04:25:36.951723', 94409.22573782134), ('2022-09-29 04:26:36.951723', 80248.25989717428), ('2022-09-29 04:27:36.951723', 113526.52962269486), ('2022-09-29 04:28:36.951723', 97949.46719798312), ('2022-09-29 04:29:36.951723', 97949.46719798312), ('2022-09-29 04:30:36.951723', 97241.41890595073), ('2022-09-29 04:31:36.951723', 100073.61207408014), ('2022-09-29 04:32:36.951723', 90868.98427765958), ('2022-09-29 04:33:36.951723', 78124.11502107722), ('2022-09-29 04:34:36.951723', 97949.46719798312), ('2022-09-29 04:35:36.951723', 97241.41890595073), ('2022-09-29 04:36:36.951723', 105737.998410339), ('2022-09-29 04:37:36.951723', 80248.25989717428), ('2022-09-29 04:38:36.951723', 97949.46719798312), ('2022-09-29 04:39:36.951723', 83080.45306530369), ('2022-09-29 04:40:36.951723', 97949.46719798312), ('2022-09-29 04:41:36.951723', 99365.56378204782), ('2022-09-29 04:42:36.951723', 104321.90182627425), ('2022-09-29 04:43:36.951723', 104321.90182627425), ('2022-09-29 04:44:36.951723', 105737.998410339), ('2022-09-29 04:45:36.951723', 100781.6603661125), ('2022-09-29 04:46:36.951723', 90160.93598562723), ('2022-09-29 04:47:36.951723', 109278.23987050075), ('2022-09-29 04:48:36.951723', 110694.33645456545), ('2022-09-29 04:49:36.951723', 141140.41301195658), ('2022-09-29 04:50:36.951723', 97241.41890595073), ('2022-09-29 04:51:36.951723', 108570.19157846837), ('2022-09-29 04:52:36.951723', 113526.52962269486), ('2022-09-29 04:53:36.951723', 114234.5779147272), ('2022-09-29 04:54:36.951723', 118482.86766692133), ('2022-09-29 04:55:36.951723', 97241.41890595073), ('2022-09-29 04:56:36.951723', 105737.998410339), ('2022-09-29 04:57:36.951723', 100073.61207408014), ('2022-09-29 04:58:36.951723', 102905.80524220955), ('2022-09-29 04:59:36.951723', 109278.23987050075), ('2022-09-29 05:00:36.951723', 114942.62620675957), ('2022-09-29 05:01:36.951723', 95117.27402985367), ('2022-09-29 05:02:36.951723', 99365.56378204782), ('2022-09-29 05:03:36.951723', 98657.51549001543), ('2022-09-29 05:04:36.951723', 100073.61207408014), ('2022-09-29 05:05:36.951723', 102197.7569501772), ('2022-09-29 05:06:36.951723', 87328.74281749783), ('2022-09-29 05:07:36.951723', 82372.40477327135), ('2022-09-29 05:08:36.951723', 100073.61207408014), ('2022-09-29 05:09:36.951723', 100073.61207408014), ('2022-09-29 05:10:36.951723', 90160.93598562723), ('2022-09-29 05:11:36.951723', 75999.97014498018), ('2022-09-29 05:12:36.951723', 96533.37061391838), ('2022-09-29 05:13:36.951723', 101489.70865814487), ('2022-09-29 05:14:36.951723', 86620.69452546547), ('2022-09-29 05:15:36.951723', 92993.12915375663), ('2022-09-29 05:16:36.951723', 83080.45306530369), ('2022-09-29 05:17:36.951723', 87328.74281749783), ('2022-09-29 05:18:36.951723', 83788.50135733603), ('2022-09-29 05:19:36.951723', 70335.58380872136), ('2022-09-29 05:20:36.951723', 70335.58380872136), ('2022-09-29 05:21:36.951723', 74583.87356091547), ('2022-09-29 05:22:36.951723', 73167.77697685077), ('2022-09-29 05:23:36.951723', 71751.68039278606), ('2022-09-29 05:24:36.951723', 68919.48722465665)]
time_fmt = '%Y-%m-%d %H:%M:%S.%f'

class TripleExponentialSmoothing:

    def __init__(self):
        print(f"Initializing TES Prediction Model")



    def optimizeHoltWinters(self, trace_history, mult):
        combinations = ["add", "mul"]
        best_model = None
        best_c = None
        best_aic = np.inf
        for c in combinations:
            model = ExponentialSmoothing(trace_history.load, seasonal_periods=mult * 24, seasonal=c,
                                         initialization_method="estimated").fit()
            aic = model.aic
            if aic < best_aic:
                best_aic = aic
                best_model = model
                best_c = c
        return best_model, best_c



if __name__ == "__main__":
    tes = TripleExponentialSmoothing()

    pd_trace = pd.DataFrame(data, columns=['date','load'])
    pd_trace.set_index('date',inplace=True)

    model, hyper_params = tes.optimizeHoltWinters(pd_trace, 12)

    model = ExponentialSmoothing(pd_trace.load, seasonal_periods=24 * 12,
                                 seasonal=hyper_params, initialization_method="estimated").fit()

    prediction = model.forecast(3)

    print(prediction.iloc[-1], prediction.index[-1])

    print(isinstance(prediction.index[-1],datetime))

    fh = datetime.strptime("2022-09-29 05:27:36.951723", time_fmt)

